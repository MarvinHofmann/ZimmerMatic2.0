const main = require("../index.js")
const si = require('systeminformation');

/**
 * Returns Information about the pi 
 * cpu usage, total memory and free memory
 */
main.app.get("/api/os_info", async function (req, res) {

    let cpu = await si.cpu().then((data) => {
        return data
    })
        .catch(error => console.error(error));

    let cpu_temp = await si.cpuTemperature().then((data) => {
        return data
    })
        .catch(error => console.error(error));

    let memory_info = await si.mem().then((data) => {
        return data
    })
        .catch(error => console.error(error));

    let load = await si.currentLoad().then((data) => {
        return data
    })
        .catch(error => console.error(error));

    let fsys = await si.fsSize().then((data) => {
        return data
    })

    let docker = await si.dockerInfo().then((data) => {
        return data
    })
        .catch(error => console.error(error));

    res.status(200).json({
        cpu_si: cpu,
        memory: memory_info,
        cpu_temp: cpu_temp,
        load: load,
        disk: fsys,
        docker: docker
    })
});